
change ifs to switch case
multiple similar schemas
handle arrays
